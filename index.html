<!-- Весь код index.html -->
<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Діна збирає мушлі</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #191919;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        #game-container {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100vw;
            height: 100vh;
            max-width: 100vw;
            max-height: 100vh;
            transform: translate(-50%, -50%);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #game-canvas {
            background: #000;
            border-radius: 1vw;
            display: block;
            /* 9:16 формат */
            width: 100vw;
            height: calc(100vw * 16 / 9);
            max-width: 100vw;
            max-height: 100vh;
            box-shadow: 0 0 24px #000a;
            margin: 0 auto;
        }
        @media (max-aspect-ratio: 9/16) {
            #game-canvas {
                height: 100vh;
                width: calc(100vh * 9 / 16);
            }
        }
        .overlay {
            pointer-events: none;
            position: absolute;
            left: 0; top: 0; width: 100%; height: 100%;
        }
        .ui {
            position: absolute;
            left: 0; top: 0; width: 100%; height: 100%;
            pointer-events: none;
        }
        .sound-btn {
            position: absolute;
            right: 2vw;
            top: 2vw;
            width: 9vw;
            height: 9vw;
            max-width: 48px;
            max-height: 48px;
            z-index: 30;
            pointer-events: auto;
            background: none;
            border: none;
        }
        .hud {
            position: absolute;
            left: 2vw; top: 2vw;
            z-index: 20;
            color: #fffcd0;
            text-shadow: 2px 2px 10px #000, 1px 1px 4px #333;
            font-size: 7vw;
            font-weight: bold;
            pointer-events: none;
        }
        .hud.right {
            left: auto;
            right: 2vw;
            text-align: right;
        }
        .controls {
            position: absolute;
            left: 0; bottom: 2vw;
            width: 100%;
            display: flex;
            justify-content: center;
            z-index: 20;
            pointer-events: none;
        }
        .controls-inner {
            display: flex;
            flex-direction: row;
            align-items: flex-end;
            gap: 4vw;
        }
        .control-btn {
            background: rgba(30,30,30,0.7);
            border-radius: 50%;
            border: none;
            width: 16vw;
            height: 16vw;
            max-width: 70px;
            max-height: 70px;
            display: flex;
            justify-content: center;
            align-items: center;
            pointer-events: auto;
        }
        .control-btn img {
            width: 9vw;
            height: 9vw;
            max-width: 36px;
            max-height: 36px;
        }
    </style>
</head>
<body>
<div id="game-container">
    <canvas id="game-canvas" width="360" height="640"></canvas>
    <!-- Інтерфейс поверх канваса -->
    <div class="ui">
        <button class="sound-btn" id="sound-btn">
            <img id="sound-icon" src="icons/sound-on.png" alt="sound" />
        </button>
        <div class="hud" style="top:2vw; left:2vw;" id="hud-left">
            <span id="score-label">Бонуси: 0</span>
        </div>
        <div class="hud right" style="top:2vw; right:2vw;" id="hud-right">
            <img src="icons/hourglass.png" style="vertical-align: middle;width:6vw;max-width:30px;"> <span id="timer-label">60</span>
        </div>
        <div class="hud" style="bottom:15vw; left:2vw; font-size:6vw;" id="hud-level">
            <span id="level-label">Рівень: 1</span>
        </div>
        <div class="controls">
            <div class="controls-inner">
                <button class="control-btn" id="left-btn"><img src="icons/left.png" alt="Left"></button>
                <button class="control-btn" id="up-btn"><img src="icons/up.png" alt="Up"></button>
                <button class="control-btn" id="down-btn"><img src="icons/down.png" alt="Down"></button>
                <button class="control-btn" id="right-btn"><img src="icons/right.png" alt="Right"></button>
            </div>
        </div>
    </div>
</div>
<audio id="game-music" src="music/yachting-song.MP3" loop></audio>
<script>
// ==== Глобальні налаштування ====
const canvas = document.getElementById('game-canvas');
const ctx = canvas.getContext('2d');
let W = canvas.width, H = canvas.height;

// Підтримка ресайзу під 9:16
function resizeCanvas() {
    let ww = window.innerWidth, wh = window.innerHeight;
    let r = 9/16;
    let w = ww, h = ww/r;
    if (h > wh) { h = wh; w = wh*r; }
    canvas.style.width = w+"px";
    canvas.style.height = h+"px";
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

// ==== ГРАФІКА ====
const bg = new Image();
bg.src = 'backgrounds/bg5.jpg'; // твоя нова картинка, 9:16!
const dinaImg = new Image();
dinaImg.src = 'icons/dina.png';
const shellImg = new Image();
shellImg.src = 'icons/shell.png';
const yachtImg = new Image();
yachtImg.src = 'yachts/yacht.png';

// ==== ЗВУК ====
const music = document.getElementById('game-music');
const soundBtn = document.getElementById('sound-btn');
const soundIcon = document.getElementById('sound-icon');
let musicEnabled = true;
soundBtn.onclick = () => {
    musicEnabled = !musicEnabled;
    if (musicEnabled) {
        music.play();
        soundIcon.src = "icons/sound-on.png";
    } else {
        music.pause();
        soundIcon.src = "icons/sound-off.png";
    }
};
music.addEventListener('canplaythrough', ()=>{if(musicEnabled) music.play()}, {once:true});
document.addEventListener('touchstart', ()=>{ if(musicEnabled) music.play(); }, {once:true});

// ==== ОБ'ЄКТИ ГРИ ====
let dina = { x: W/2, y: H*0.8, size: 60, scale: 1, dx: 0, dy: 0 };
let yacht = { x: W/2, y: H*0.2, size: 80, dx: 0.3, dy: 0.12 };
let shells = [];
let level = 1, score = 0, time = 35, timerId = null;

// ==== ІНТЕРФЕЙС ====
const scoreLabel = document.getElementById('score-label');
const timerLabel = document.getElementById('timer-label');
const levelLabel = document.getElementById('level-label');

// ==== ГЕНЕРАЦІЯ МУШЕЛЬ ====
function randomShell() {
    return {
        x: 40 + Math.random()*(W-80),
        y: 80 + Math.random()*(H-220),
        size: 42
    }
}
function spawnShells() {
    shells = [];
    for(let i=0; i<3+level; ++i) shells.push(randomShell());
}

// ==== РУХ ДІНИ ТА КЕРУВАННЯ ====
function moveDina(dx,dy) {
    dina.x = Math.min(W-dina.size/2, Math.max(dina.size/2, dina.x+dx));
    dina.y = Math.min(H-dina.size/2, Math.max(dina.size/2, dina.y+dy));
}
let keyState = {};
document.addEventListener('keydown', e => {
    if(e.code=="ArrowLeft") moveDina(-20,0);
    if(e.code=="ArrowRight") moveDina(20,0);
    if(e.code=="ArrowUp") moveDina(0,-20);
    if(e.code=="ArrowDown") moveDina(0,20);
});

document.getElementById('left-btn').onclick = () => moveDina(-24,0);
document.getElementById('right-btn').onclick = () => moveDina(24,0);
document.getElementById('up-btn').onclick = () => moveDina(0,-24);
document.getElementById('down-btn').onclick = () => moveDina(0,24);

// ==== АНІМАЦІЯ ====
function draw() {
    // 1. фон
    ctx.drawImage(bg, 0, 0, W, H);
    // 2. яхта
    ctx.drawImage(yachtImg, yacht.x-yacht.size/2, yacht.y-yacht.size/2, yacht.size, yacht.size);
    // 3. мушлі
    for(let sh of shells)
        ctx.drawImage(shellImg, sh.x-sh.size/2, sh.y-sh.size/2, sh.size, sh.size);
    // 4. Діна
    ctx.drawImage(dinaImg, dina.x-dina.size/2*dina.scale, dina.y-dina.size/2*dina.scale, dina.size*dina.scale, dina.size*dina.scale);
}
function update() {
    // яхта рухається трохи в сторони для живості
    yacht.x += yacht.dx; yacht.y += yacht.dy;
    if(yacht.x<60||yacht.x>W-60) yacht.dx*=-1;
    if(yacht.y<60||yacht.y>H-200) yacht.dy*=-1;
    // перевірка зіткнень Діни з мушлями
    for(let i=shells.length-1;i>=0;--i) {
        let sh=shells[i];
        let d = Math.hypot(dina.x-sh.x,dina.y-sh.y);
        if(d < 36*dina.scale) {
            shells.splice(i,1);
            score += 50;
            dina.scale = Math.min(3, dina.scale+0.07); // max 3x
        }
    }
    // якщо зібрано всі - новий рівень
    if(shells.length==0) nextLevel();
    // оновити інтерфейс
    scoreLabel.textContent = `Бонуси: ${score}`;
    timerLabel.textContent = time;
    levelLabel.textContent = `Рівень: ${level}`;
}
function gameLoop() {
    W = canvas.width; H = canvas.height;
    ctx.clearRect(0,0,W,H);
    draw();
    update();
    requestAnimationFrame(gameLoop);
}

// ==== ТАЙМЕР ====
function tickTimer() {
    time--;
    timerLabel.textContent = time;
    if(time<=0) {
        alert('Час вичерпано!\nТвій рахунок: '+score);
        restartGame();
        return;
    }
    timerId = setTimeout(tickTimer,1000);
}

function nextLevel() {
    level++; time = 30+level*2; dina.scale=1;
    spawnShells();
}
function restartGame() {
    level=1; score=0; time=35; dina.scale=1;
    dina.x = W/2; dina.y = H*0.8;
    yacht.x = W/2; yacht.y = H*0.2;
    spawnShells();
    if(timerId) clearTimeout(timerId);
    timerId = setTimeout(tickTimer, 1000);
}

// ==== ЗАПУСК ====
window.onload = () => {
    W = canvas.width; H = canvas.height;
    dina.x = W/2; dina.y = H*0.8;
    yacht.x = W/2; yacht.y = H*0.2;
    dina.scale=1;
    spawnShells();
    if(timerId) clearTimeout(timerId);
    time = 35; timerLabel.textContent = time;
    timerId = setTimeout(tickTimer, 1000);
    gameLoop();
    resizeCanvas();
};
</script>
</body>
</html>
